\Algo[H]
{Преобразование КС"/грамматики к нормальной форме Хомского}
{\label{algo-Homsky}КС-грамматика $G=(N,\Sigma,P,S)$.}
{КС-грамматика $G'$ в нормальной форме Хомского, у которой $L(G')=L(G)$.}
{Предварительное приведение исходной грамматики и последовательное конструирование продукций новой грамматики.}
{
\item
Ввести новый стартовый нетерминал $S_1$ и добавить к $P$ одну продукцию $S_1\to S$. Применить к модифицированной грамматике алгоритм~\ref{algo-NormalGrammar} и построить тем самым приведенную КС"/грамматику $G_1=(N_1,\Sigma,P_1,S_1)$, в продукциях которой $S_1$ не встречается в правых частях. Перейти на следующий шаг, где начинается построение искомой грамматики $G'=(N',\Sigma,P',S_1)$.

\item Включить в $P'$ все продукции из $P_1$, вида $A\to a$, где $A\in N_1$, $a\in\Sigma$.

\item Включить в $P'$ все продукции из $P_1$ вида $A\to BC$, где $A,B,C\in N_1$.

\item Включить в $P'$ продукцию $S_1\to\eps$, если она была в $P_1$.

\item Для каждой продукции из $P$ вида $A\to X_1 \ldots X_k$ включить в $P'$ продукции
\begin{align*}
    A  &\to X'_1 \la X_2\ldots X_k \ra, \\
    \la X_2 \ldots X_k> &\to X'_2 \la X_3\ldots X_k \ra, \\
     & \ldots\\
    \la X_{k-2} X_{k-1} X_k> &\to X'_{k-2} \la X_{k-1} X_k \ra, \\
    \la X_{k-1} X_k \ra &\to X'_{k-1} X'_k,
\end{align*}
где $X'_i=X_i$, если $X_i\in N$, и $X'_i$~--- новый нетерминал,
если $X_i\in\Sigma$, а $\la X_i\ldots X_k \ra$~--- новый нетерминал в
любом случае.

\item Для каждой продукции из $P$ вида $A\to X_1X_2$, где хотя бы один из символов $X_1$ и $X_2$ принадлежит $\Sigma$, включить в $P'$ продукцию $A\to X'_1X'_2$, где $X'_i$ определяется так же, как на шаге 5.

\item Для каждого нетерминала вида $a'$, введенного на шагах 5 и 6, включить в $P'$ продукцию $a'\to a$.

\item Положить $G'=(N',\Sigma,P',S_1)$.
}
